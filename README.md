# AI
**Кейс для Т-Образования.**\
*Задача*: Создать REST API сервис, который сможет обнаруживать логотип Т-Банка (игнорируя логотипы "Тинькофф") на загружаемых изображениях и возвращать координаты найденных логотипов.

# Оглавление:
1. [План работ](#План-работ)
2. [Технологический стек](#технологический-стек)
3. [Ход выполения](#ход-выполения)
4. [Инструкции по установке](#инструкции-по-установке)
5. [Документация решения](#документация-решения)

<br><br/>
---
<br><br/>

# План работ:
В этом разделе вы найдёте задачи, которые были выполнены в рамках проекта и те, что ещё предстоит выполнить.
- [ ] Подготовка данных и разметка (*04-10.09.2025*)
  - [ ] Установка зависимостей (*04.09.2025*)
  - [ ] Проверка совместимости компонетов (*04.09.2025*)
  - [ ] Дополнение датасета (если потребуется)
  - [ ] Разметка датасета zero-shot с CLIP (*05-09.09.2025*)
  - [ ] Разделение на train/val и финализация (*09.09.2025*)
  - [ ] Проверка (*09-10.09.2025*)

- [ ] Обучение модели (*10-14.09.2025*)
  - [ ] Создание скриптов (*10.09.2025*)
  - [ ] ...
     
- [ ] Реализация API сервиса (*10-12.09.2025*)
  - [ ] Создание FastAPI-приложения с эндпоинтом /detect: загрузка файла, обработка моделью, возврат DetectionResponse.(*10-11.09.2025*)
  - [ ] Тестирование и отладка (*11-12.09.2025*)
     
- [ ] Валидация и метрики (*14-16.09.2025*)
  - [ ] Написать Python-скрипт для подсчета Precision/Recall/F1 на val-наборе.
  - [ ] Использовать OpenCV для отрисовки bounding boxes на изображениях.
     
- [ ] Упаковка и развертывание <ins>(***перенести***)</ins>
  - [ ] Создайте Dockerfile
  - [ ] Форматирование и дополнение документации

<br><br/>
---
<br><br/>

# Технологический стек
Данный раздел описывает оптимальный технологический стек для реализации проекта детекции логотипа Т-Банка на основе машинного обучения и REST API. Стек выбран с учетом требований кейса (производительность на GPU T4, ограничения по времени ≤10 с, поддержка форматов изображений, интеграция zero-shot подходов) и известных трендов разработки (на момент составления).

| Категория |	Компонент	| Версия | Обоснование и цель |
| --- | --- | --- | --- |
| Язык программирования	| Python	| 3.13	| Базовый язык для всего проекта. Python 3.13 предлагает улучшенную производительность в async/await (лучше чем 3.12), что идеально для FastAPI-инференса. Использование cpython 3.13.0+ для оптимизаций в ML-задачах. |
| Фреймворк API |	FastAPI + Pydantic |	FastAPI 0.115+, Pydantic 2.10+ |	Для строгого REST API с автогенерацией документации (Swagger). Pydantic обеспечивает валидацию входных данных (размеры изображений, форматы). Поддерживает async для параллельной обработки изображений, укладываясь в 10-сек лимит. |
| Сервер ASGI |	Uvicorn |	0.31+ |	Запуск FastAPI в продакшн. Легкий, быстрый, с поддержкой нескольких GPU. |
| ML-фреймворк |	PyTorch	| 2.4+	| Основной для нейронных сетей (YOLO, CLIP). Версии 2.4+ имеют улучшенный инференс с TorchCompile JIT. **Требует CUDA 11.8+ для GPU (T4): pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118.** |
| Модели ML |	YOLOv8 (ultralytics) |	8.3+	| Для детекции объектов (*bounding boxes логотипа*). YOLOv8 (2023) на 10-20% точнее и быстрее YOLOv5, поддерживает zero-shot и custom datasets. _Альтернатива: YOLOv9/10 для future-proofing, если точность <25%._ |
| Zero-shot ML |	CLIP (OpenAI, via transformers) |	Hugging Face transformers 4.46+ |	Для zero-shot классификации логотипов без полного датасета. Интегрируется с PyTorch; использование model "openai/clip-vit-base-patch16" для speed/accuracy. |
| Обработка изображений |	OpenCV + Pillow	| OpenCV 4.10+, Pillow 11.0+ |	OpenCV для предобработки (*grayscale, resize*), Pillow для загрузки/сохранения внешних форматов (JPEG, PNG, BMP, WEBP). Дополняют друг друга без конфликтов. |
| HTTP-клиент	| Requests	| 2.32+	| Для загрузки изображений по URL (асинхронно в FastAPI). Простой и надежный. |
| Контейнеризация |	Docker	| 27+	| Для iso-пакетарования приложения. **Добавить multi-stage builds для уменьшения размера образа**. |
| GPU-ускорение	| CUDA Toolkit	| 12.6+ |	Для PyTorch GPU. **На T4: установить drivers NVIDIA 470+**. |
| Тестирование и валидация	| Pytest + Sklearn + TorchEval	| Pytest 8.3+, Sklearn 1.5+, TorchEval 1.2+	| Pytest для unit/integration tests. Sklearn/TorchEval для ML-метрик (F1-score, Precision/Recall при IoU=0.5). ***Убедитться, что модель достигает 25% точности на тестовом сете***. |
| Логирование и мониторинг	| Loguru + prometheus-fastapi-instrumentator	| Loguru 0.7+, prometheus-fastapi 2.0+	| Loguru для структурированных логов (ошибки, timeouts). Prometheus для метрик internal (inference time, GPU usage) — **интегрировать с Grafana**. |
| Дополнительные утилиты	| NumPy, Matplotlib	| NumPy 2.1+, Matplotlib 3.9+	| NumPy для векторных операций. Matplotlib для визуализации результатов (bounding boxes на изображениях) в документах/отчетах. |

### Комментарии к установке и зависимостям
Использовать pip freeze для фиксации после установки.\
Создайть виртуальное окружение: python3.13 -m venv env (или conda для ML).\
Установить корневые зависимости: скопировать и выполнить из requirements.txt:
```
# Core
fastapi==0.115.6
pydantic==2.10.1
uvicorn==0.31.1
torch==2.4.1+cu118 --index-url https://download.pytorch.org/whl/cu118
ultralytics==8.3.28
transformers==4.46.2
opencv-python==4.10.0.84
pillow==11.0.0
requests==2.32.3
# Validation & Testing
pytest==8.3.3
scikit-learn==1.5.2
torcheval==1.2.0
matplotlib==3.9.2
numpy==2.1.1
# Logging & Monitoring
loguru==0.7.2
prometheus-fastapi-instrumentator==2.0.1
```
Команда запуска: после Docker build: uvicorn main:app --host 0.0.0.0 --port 8000 --workers 4 (workers для multi-GPU если возможно).\
GPU check: добавить в код torch.cuda.is_available() для верификации T4.

<br><br/>
---
<br><br/>

# Ход выполения
В этом разделе зафиксированы все шаги, сделанные в рамках этого кейса.
1. Был составлен примерный план работ и первичная документация на основе: <ins>анализа задачи</ins>, <ins>поиска аутуальных технологий</ins> (*открытые источники и нейросети*) и тайм менеджмента.
2. ...

<br><br/>
---
<br><br/>

# Инструкции по установке
В этом разделе указаны инструкции по установке проекта и его развёртыванию.

---

# Документация решения
Этот раздел посвящён детальному описанию решения.
